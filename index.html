<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Studio EDU Global Pro</title>
    <style>
        :root {
            --primary-color: #6c5ce7;
            --bg-gradient: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            --panel-bg: #ffffff;
        }

        /* –®–∞–±–ª–æ–Ω—ã */
        .template-1 { --primary-color: #6c5ce7; --bg-gradient: linear-gradient(135deg, #a29bfe, #6c5ce7); }
        .template-2 { --primary-color: #ff7675; --bg-gradient: linear-gradient(135deg, #fab1a0, #ff7675); }
        .template-3 { --primary-color: #00b894; --bg-gradient: linear-gradient(135deg, #55efc4, #00b894); }
        .template-4 { --primary-color: #0984e3; --bg-gradient: linear-gradient(135deg, #74b9ff, #0984e3); }
        .template-5 { --primary-color: #e17055; --bg-gradient: linear-gradient(135deg, #ffcc33, #e17055); }
        .template-6 { --primary-color: #fd79a8; --bg-gradient: linear-gradient(135deg, #fab1a0, #fd79a8); }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg-gradient);
            display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0;
            transition: 0.5s;
        }

        .container {
            display: grid; grid-template-columns: 380px 520px; gap: 25px; padding: 20px;
        }

        .panel {
            background: var(--panel-bg); padding: 25px; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .header-area { 
            display: flex; align-items: center; gap: 15px; margin-bottom: 20px; border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; 
        }
        
        /* –õ–æ–≥–æ—Ç–∏–ø —Ç–µ–ø–µ—Ä—å –∏—â–µ—Ç logo.png */
        .logo { 
            width: 55px; height: 55px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary-color);
            background: #f0f0f0;
        }

        .form-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.85rem; color: #666; margin-bottom: 5px; font-weight: 600; }
        
        select, input, textarea {
            width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #ddd; font-size: 0.9rem; box-sizing: border-box;
        }

        .btn {
            width: 100%; min-height: 50px; border: none; border-radius: 15px;
            background: var(--primary-color); color: white; cursor: pointer; font-weight: bold;
            display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 12px;
            font-size: 1rem; transition: 0.3s;
        }
        .btn:hover { filter: brightness(1.1); transform: translateY(-2px); }

        .mixer-box { background: #f9f9fb; padding: 15px; border-radius: 18px; border: 1px solid #eee; margin-top: 10px; }
        .mixer-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; font-size: 0.85rem; }
        .mixer-row input { width: 150px; accent-color: var(--primary-color); }

        .player-display { display: flex; flex-direction: column; align-items: center; }
        .cover-art { 
            width: 100%; height: 260px; background: #eee center/cover no-repeat; border-radius: 20px; 
            margin-bottom: 15px; border: 5px solid #fff; box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        #timer-display { font-size: 1.5rem; font-weight: bold; color: #ff4757; margin-bottom: 10px; display: none; }

        .controls { display: flex; gap: 20px; margin: 15px 0; }
        .control-btn { 
            background: var(--primary-color); color: white; border: none; width: 60px; height: 60px; 
            border-radius: 20px; cursor: pointer; font-size: 1.5rem; transition: 0.2s;
        }
        .control-btn:active { transform: scale(0.9); }

        #iframe-output { height: 70px; background: #f4f4f9; border: 1px solid #ccd; font-family: monospace; font-size: 0.8rem; padding: 10px; }
    </style>
</head>
<body class="template-1">

<div class="container">
    <div class="panel">
        <div class="header-area">
            <img src="logo.png" class="logo" onerror="this.src='https://via.placeholder.com/55?text=Logo'" alt="Logo">
            <h2 style="margin:0;">Audio Studio EDU</h2>
        </div>
        
        <div class="form-group">
            <label>üåê –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</label>
            <select id="langSelect">
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="zh">‰∏≠Êñá</option>
                <option value="de">Deutsch</option>
                <option value="en">English</option>
            </select>
        </div>

        <div class="form-group">
            <label>üéì –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è</label>
            <select id="modeSelect">
                <option value="teacher">–£—á–∏—Ç–µ–ª—å (Teacher)</option>
                <option value="student">–£—á–µ–Ω–∏–∫ (Student)</option>
                <option value="exam">–≠–∫–∑–∞–º–µ–Ω (Exam)</option>
            </select>
        </div>

        <div class="form-group">
            <label>üé® –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É (Template)</label>
            <select id="templateSelect">
                <option value="template-1">Soft Gradient 1</option>
                <option value="template-2">Soft Gradient 2</option>
                <option value="template-3">Soft Gradient 3</option>
                <option value="template-4">Soft Gradient 4</option>
                <option value="template-5">Soft Gradient 5</option>
                <option value="template-6">Soft Gradient 6</option>
            </select>
        </div>

        <div class="mixer-box">
            <label style="color: var(--primary-color); font-weight: bold; margin-bottom: 10px; display: block;">üéöÔ∏è –ê—É–¥–∏–æ–º–∏–∫—à–µ—Ä PRO</label>
            <div class="mixer-row"><span>–ì—Ä–æ–º–∫–æ—Å—Ç—å</span><input type="range" id="volRange" min="0" max="1" step="0.1" value="1"></div>
            <div class="mixer-row"><span>–ë–∞—Å</span><input type="range" id="bassRange" min="-10" max="20" step="1" value="0"></div>
            <div class="mixer-row" style="background: #efecff; padding: 8px; border-radius: 10px;">
                <span>ü§ñ –≠—Ñ—Ñ–µ–∫—Ç –†–û–ë–û–¢</span>
                <input type="checkbox" id="robotCheck" style="width: 22px; height: 22px;">
            </div>
        </div>

        <button class="btn" id="randomCoverBtn" style="background: #55efc4; color: #2d3436;">‚ú® –°–ª—É—á–∞–π–Ω–∞—è –æ–±–ª–æ–∂–∫–∞</button>
        
        <label style="margin-top:20px;">üì¶ –ö–æ–¥ iframe –¥–ª—è Genially:</label>
        <textarea id="iframe-output" readonly></textarea>
        <button class="btn" id="copyIframeBtn" style="background: #a29bfe;">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
    </div>

    <div class="panel player-display">
        <div class="cover-art" id="coverArt" style="background-image: url('https://picsum.photos/seed/music/500/500');"></div>
        
        <div id="timer-display">02:00</div>
        
        <canvas id="visualizer" style="width:100%; height:60px;"></canvas>
        
        <div style="width:100%;">
            <div id="timeDisplay" style="text-align:center; font-size:1rem; margin-bottom: 8px; font-family: monospace;">00:00 / 00:00</div>
            <input type="range" id="progressBar" value="0" min="0" step="0.1" style="width:100%;">
        </div>

        <div class="controls">
            <button class="control-btn" id="rewindBtn">‚è™</button>
            <button class="control-btn" id="playBtn" style="width:80px; height:80px; border-radius: 50%; font-size: 2rem;">‚ñ∂</button>
            <button class="control-btn" id="forwardBtn">‚è©</button>
        </div>
        
        <div class="form-group" style="width:100%;">
            <label>üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ê—É–¥–∏–æ –∏ –û–±–ª–æ–∂–∫—É</label>
            <input type="file" id="audioUpload" accept="audio/*">
            <input type="file" id="coverUpload" accept="image/*" style="margin-top:8px;">
        </div>
        <audio id="mainAudio" crossorigin="anonymous"></audio>
    </div>
</div>

<script>
    const audio = document.getElementById('mainAudio');
    const playBtn = document.getElementById('playBtn');
    const modeSelect = document.getElementById('modeSelect');
    const timerDisplay = document.getElementById('timer-display');
    const templateSelect = document.getElementById('templateSelect');
    
    let audioContext, analyser, source, bassFilter, distortion;
    let examInterval;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞
    function initAudio() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            analyser = audioContext.createAnalyser();
            source = audioContext.createMediaElementSource(audio);
            
            bassFilter = audioContext.createBiquadFilter();
            bassFilter.type = "lowshelf";
            bassFilter.frequency.value = 200;

            distortion = audioContext.createWaveShaper();
            distortion.oversample = '4x';

            source.connect(bassFilter).connect(distortion).connect(analyser).connect(audioContext.destination);
            drawVisualizer();
        }
    }

    // –≠—Ñ—Ñ–µ–∫—Ç –†–æ–±–æ—Ç–∞
    function makeDistortion(amount) {
        let n = 44100, curve = new Float32Array(n), deg = Math.PI / 180;
        for (let i = 0 ; i < n; ++i ) {
            let x = i * 2 / n - 1;
            curve[i] = ( 3 + amount ) * x * 20 * deg / ( Math.PI + amount * Math.abs(x) );
        }
        return curve;
    }

    document.getElementById('robotCheck').onchange = (e) => {
        if (distortion) distortion.curve = e.target.checked ? makeDistortion(400) : null;
    };

    document.getElementById('volRange').oninput = (e) => audio.volume = e.target.value;
    document.getElementById('bassRange').oninput = (e) => { if (bassFilter) bassFilter.gain.value = e.target.value; };

    // –¢–∞–π–º–µ—Ä –≠–∫–∑–∞–º–µ–Ω–∞
    modeSelect.onchange = () => {
        timerDisplay.style.display = (modeSelect.value === 'exam') ? 'block' : 'none';
        timerDisplay.innerText = "02:00";
    };

    function startExam() {
        let time = 120;
        clearInterval(examInterval);
        examInterval = setInterval(() => {
            time--;
            let m = Math.floor(time/60), s = time%60;
            timerDisplay.innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            if (time <= 0) { clearInterval(examInterval); audio.pause(); }
        }, 1000);
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–µ—Ä–æ–º
    playBtn.onclick = () => {
        if (!audio.src) return;
        initAudio();
        if (audio.paused) {
            audio.play();
            playBtn.innerText = '‚è∏';
            if (modeSelect.value === 'exam') startExam();
        } else {
            audio.pause();
            playBtn.innerText = '‚ñ∂';
            clearInterval(examInterval);
        }
    };

    // –°–ª—É—á–∞–π–Ω–∞—è –æ–±–ª–æ–∂–∫–∞
    document.getElementById('randomCoverBtn').onclick = () => {
        const id = Math.floor(Math.random() * 1000);
        document.getElementById('coverArt').style.backgroundImage = `url('https://picsum.photos/seed/${id}/500/500')`;
    };

    // –í–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
    function drawVisualizer() {
        requestAnimationFrame(drawVisualizer);
        const data = new Uint8Array(analyser.frequencyBinCount);
        analyser.getByteFrequencyData(data);
        const ctx = document.getElementById('visualizer').getContext('2d');
        ctx.clearRect(0, 0, 300, 100);
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--primary-color');
        for (let i = 0; i < 60; i++) ctx.fillRect(i * 5, 60, 3, -(data[i] / 4));
    }

    // Iframe –∏ –ü—Ä–æ–≥—Ä–µ—Å—Å
    document.getElementById('copyIframeBtn').onclick = () => {
        const code = `<iframe src="${window.location.href}" width="100%" height="750px" frameborder="0"></iframe>`;
        navigator.clipboard.writeText(code);
        alert("–ö–æ–¥ –¥–ª—è Genially —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!");
    };

    templateSelect.onchange = () => document.body.className = templateSelect.value;
    
    document.getElementById('audioUpload').onchange = (e) => { if (e.target.files[0]) { audio.src = URL.createObjectURL(e.target.files[0]); audio.load(); }};
    document.getElementById('coverUpload').onchange = (e) => { if (e.target.files[0]) document.getElementById('coverArt').style.backgroundImage = `url(${URL.createObjectURL(e.target.files[0])})`; };
    
    audio.ontimeupdate = () => {
        document.getElementById('progressBar').max = audio.duration || 0;
        document.getElementById('progressBar').value = audio.currentTime;
        const fmt = s => new Date(s * 1000).toISOString().substr(14, 5);
        document.getElementById('timeDisplay').innerText = `${fmt(audio.currentTime)} / ${fmt(audio.duration || 0)}`;
    };
    document.getElementById('progressBar').oninput = (e) => audio.currentTime = e.target.value;
    document.getElementById('rewindBtn').onclick = () => audio.currentTime -= 10;
    document.getElementById('forwardBtn').onclick = () => audio.currentTime += 10;
</script>
</body>
</html>
