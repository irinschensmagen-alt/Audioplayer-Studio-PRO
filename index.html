<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Audio Studio Pro: Master Edition</title>
    <style>
        :root { 
            --gold: linear-gradient(135deg, #d4af37, #f1c40f, #c5a028);
            --gold-text: #b8860b;
            --danger: #e74c3c;
            --success: #27ae60;
        }

        @keyframes chameleon {
            0% { background-color: #f3e5f5; }
            50% { background-color: #e3f2fd; }
            100% { background-color: #f3e5f5; }
        }

        body { 
            font-family: 'Segoe UI', sans-serif; margin: 0; 
            animation: chameleon 20s infinite alternate;
            color: #444; display: flex; height: 100vh; overflow: hidden; 
        }

        .container { display: grid; grid-template-columns: 320px 1fr 450px; width: 100%; transition: 0.5s; }
        .container.test-mode { grid-template-columns: 320px 1fr 0px; }

        /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .settings { background: rgba(255, 255, 255, 0.95); padding: 20px; border-right: 1px solid rgba(0,0,0,0.1); overflow-y: auto; backdrop-filter: blur(15px); }
        .header { display: flex; align-items: center; gap: 10px; border-bottom: 2px solid #f1c40f; padding-bottom: 10px; margin-bottom: 15px; }
        .logo-img { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #d4af37; }

        /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .player-view { padding: 20px; display: flex; flex-direction: column; align-items: center; overflow-y: auto; }
        .cover { 
            width: 100%; max-width: 450px; height: 250px; border-radius: 20px; 
            background: #fff center/cover no-repeat; border: 5px solid white; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; 
            margin-bottom: 20px; position: relative;
        }
        .cover:not(.has-img)::after { content: "üéµ"; font-size: 60px; opacity: 0.2; }

        /* –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ */
        .materials-view { background: white; border-left: 2px solid #ddd; display: flex; flex-direction: column; }
        .viewer-header { background: #f8f9fa; padding: 10px; display: flex; justify-content: space-between; border-bottom: 1px solid #ddd; }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        label { display: block; font-size: 0.7rem; font-weight: 800; margin-top: 12px; color: var(--gold-text); text-transform: uppercase; }
        select, input, textarea { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-top: 5px; font-size: 0.85rem; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 12px; background: var(--gold); color: white; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(212,175,55,0.4); }

        .controls { display: flex; gap: 20px; align-items: center; margin: 20px 0; }
        .c-btn { width: 50px; height: 50px; border-radius: 15px; border: none; background: white; color: #d4af37; font-size: 1.2rem; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        #play-btn { width: 75px; height: 75px; border-radius: 50%; background: var(--gold); color: white; font-size: 1.8rem; }

        #prog { width: 100%; max-width: 500px; accent-color: #d4af37; cursor: pointer; }
        .card { background: white; padding: 15px; border-radius: 15px; margin-top: 10px; width: 100%; max-width: 500px; border: 1px solid #eee; }

        /* –°–ø–µ—Ü-–æ–∫–Ω–æ –¥–ª—è PDF */
        #doc-frame { width: 100%; height: 100%; flex-grow: 1; }
        #lock-screen { position: absolute; inset: 0; background: white; z-index: 10000; display: none; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="lock-screen">
    <h1 style="color:var(--danger); font-size: 3rem;">TIME IS UP</h1>
    <button class="btn" style="width:200px" onclick="location.reload()">RESTART</button>
</div>

<div class="container" id="main-container">
    <div class="settings">
        <div class="header">
            <img src="https://irinschensmagen-alt.github.io/Audioplayer-Studio-Pro/logo.png" class="logo-img">
            <h3 id="ui-title">Audio Studio Pro</h3>
        </div>

        <label>Language / –Ø–∑—ã–∫</label>
        <select id="langSelect" onchange="translateUI()">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option><option value="en">English</option><option value="de">Deutsch</option>
            <option value="zh">‰∏≠Êñá</option><option value="es">Espa√±ol</option><option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option><option value="fa">ŸÅÿßÿ±ÿ≥€å</option><option value="pt">Portugu√™s</option>
            <option value="ja">Êó•Êú¨Ë™û</option><option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option><option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
            <option value="fr">Fran√ßais</option><option value="th">‡πÑ‡∏ó‡∏¢</option><option value="tr">T√ºrk√ße</option>
            <option value="ko">ÌïúÍµ≠Ïñ¥</option><option value="el">ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨</option><option value="da">ÿØÿ±€å</option>
        </select>

        <label>Mode / –†–µ–∂–∏–º</label>
        <select id="modeSelect" onchange="applyMode()">
            <option value="master">Master (Loop)</option>
            <option value="study" selected>Study (–£—á–µ–Ω–∏–∫)</option>
            <option value="test">Test (Exam)</option>
        </select>

        <button class="btn" id="slowBtn" style="background:#27ae60" onclick="toggleSlow()">üê¢ SLOW 0.8x</button>

        <label>Study Materials / PDF</label>
        <input type="file" id="docFile" accept=".pdf,.doc,.docx">
        
        <label>Dictionary / –°–ª–æ–≤–∞—Ä—å</label>
        <div style="display:flex; gap:5px;">
            <input type="text" id="dictUrl" placeholder="https://...">
            <button class="btn" style="width:50px; margin-top:4px;" onclick="forceOpenDict()">‚Üó</button>
        </div>

        <label>Embed Code</label>
        <textarea id="code-out" rows="2" readonly></textarea>
        <button class="btn" onclick="copyCode()">Copy Code</button>
    </div>

    <div class="player-view">
        <div id="status-display" style="font-weight:900; color:red; height:20px;"></div>
        <div class="cover" id="cover-div"></div>
        <input type="range" id="prog" value="0" step="0.1" oninput="audio.currentTime=this.value">
        <div id="time-txt" style="font-weight:bold; margin:10px;">00:00 / 00:00</div>
        
        <div class="controls">
            <button class="c-btn" onclick="audio.currentTime-=10">‚è™</button>
            <button class="c-btn" id="play-btn" onclick="togglePlay()">‚ñ∂</button>
            <button class="c-btn" onclick="audio.currentTime+=10">‚è©</button>
        </div>

        <div class="card">
            <label>Audio Source (URL + File –ü–ö)</label>
            <input type="text" id="audUrl" placeholder="Paste URL..." oninput="loadAudio(this.value)">
            <input type="file" id="audFile" accept="audio/*" onchange="loadAudioFile(this)">
        </div>

        <div class="card">
            <label>Cover Image (URL + File –ü–ö)</label>
            <input type="text" id="imgUrl" placeholder="Paste Image URL..." oninput="loadImg(this.value)">
            <input type="file" id="imgFile" accept="image/*" onchange="loadImgFile(this)">
        </div>
    </div>

    <div class="materials-view" id="mat-panel">
        <div class="viewer-header">
            <button class="btn" style="width:auto; margin:0; padding:5px 15px;" onclick="zoomPDF(1.2)">‚ûï Zoom</button>
            <span id="mat-title" style="font-weight:bold; align-self:center;">Dictionary/PDF</span>
            <button class="btn" style="width:auto; margin:0; padding:5px 15px;" onclick="zoomPDF(0.8)">‚ûñ Zoom</button>
        </div>
        <iframe id="doc-frame" src=""></iframe>
        <div id="hint-text" style="padding:20px; text-align:center; color:#888;">
            Upload PDF or Paste Dictionary Link. <br> Use ‚Üó for blocked sites.
        </div>
    </div>
</div>

<script>
    const audio = new Audio();
    let plays = 0;
    let currentZoom = 1;

    // –ó–ê–ì–†–£–ó–ö–ê –ê–£–î–ò–û (–ò–°–ü–†–ê–í–õ–ï–ù–û)
    function loadAudio(url) { if(url) { audio.src = url; plays = 0; } }
    function loadAudioFile(input) {
        if(input.files[0]) {
            const url = URL.createObjectURL(input.files[0]);
            audio.src = url;
            plays = 0;
            console.log("Audio loaded from PC");
        }
    }

    // –ó–ê–ì–†–£–ó–ö–ê –ö–ê–†–¢–ò–ù–ö–ò (–ò–°–ü–†–ê–í–õ–ï–ù–û)
    function loadImg(url) { 
        const div = document.getElementById('cover-div');
        div.style.backgroundImage = `url(${url})`;
        div.classList.add('has-img');
    }
    function loadImgFile(input) {
        if(input.files[0]) {
            const url = URL.createObjectURL(input.files[0]);
            loadImg(url);
        }
    }

    // PDF –ò –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï
    document.getElementById('docFile').onchange = function(e) {
        if(this.files[0]) {
            const url = URL.createObjectURL(this.files[0]);
            document.getElementById('doc-frame').src = url + '#toolbar=1&navpanes=0';
            document.getElementById('hint-text').style.display = 'none';
        }
    };

    function zoomPDF(factor) {
        currentZoom *= factor;
        document.getElementById('doc-frame').style.transform = `scale(${currentZoom})`;
        document.getElementById('doc-frame').style.transformOrigin = 'top left';
    }

    // –°–õ–û–í–ê–†–¨ –ò –û–ë–•–û–î –ë–õ–û–ö–ò–†–û–í–ö–ò
    function forceOpenDict() {
        const url = document.getElementById('dictUrl').value;
        if(url) {
            window.open(url, 'DictWindow', 'width=600,height=800,left=1000,top=100');
        } else {
            alert("Please enter a link first!");
        }
    }

    // –†–ï–ñ–ò–ú–´
    function applyMode() {
        const m = document.getElementById('modeSelect').value;
        const container = document.getElementById('main-container');
        if(m === 'test') {
            container.classList.add('test-mode');
        } else {
            container.classList.remove('test-mode');
        }
        document.getElementById('slowBtn').style.display = (m === 'study') ? 'block' : 'none';
        plays = 0;
        audio.playbackRate = 1;
    }

    // –£–ü–†–ê–í–õ–ï–ù–ò–ï
    function togglePlay() { 
        if(!audio.src) return;
        audio.paused ? audio.play() : audio.pause(); 
    }
    function toggleSlow() {
        audio.playbackRate = (audio.playbackRate === 1) ? 0.8 : 1;
        document.getElementById('slowBtn').innerText = (audio.playbackRate === 0.8) ? "üê¢ SLOW ON" : "üê¢ SLOW OFF";
    }

    audio.onplay = () => {
        if(document.getElementById('modeSelect').value === 'test' && audio.currentTime === 0) {
            plays++;
            if(plays > 2) { audio.pause(); document.getElementById('lock-screen').style.display = 'flex'; }
        }
        document.getElementById('play-btn').innerText = '‚è∏';
    };
    audio.onpause = () => document.getElementById('play-btn').innerText = '‚ñ∂';
    
    audio.ontimeupdate = () => {
        const p = document.getElementById('prog');
        p.max = audio.duration || 0;
        p.value = audio.currentTime;
        const fmt = s => new Date(s * 1000).toISOString().substr(14, 5);
        document.getElementById('time-txt').innerText = `${fmt(audio.currentTime)} / ${fmt(audio.duration || 0)}`;
        
        if(document.getElementById('modeSelect').value === 'test' && audio.currentTime >= audio.duration && audio.duration > 0) {
             document.getElementById('lock-screen').style.display = 'flex';
        }
    };

    function copyCode() {
        const code = `<iframe src="${window.location.href}" width="100%" height="750" frameborder="0"></iframe>`;
        navigator.clipboard.writeText(code); alert("Embed code copied!");
    }

    applyMode();
</script>
</body>
</html>
